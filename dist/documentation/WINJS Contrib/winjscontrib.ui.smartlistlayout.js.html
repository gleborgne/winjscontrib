<!DOCTYPE html>

<html lang="en">
<head>
	<meta charset="utf-8">
	<title>WinJS Contrib Source: winjscontrib.ui.smartlistlayout.js</title>

	<!--[if lt IE 9]>
	<script src="//html5shiv.googlecode.com/svn/trunk/html5.js"></script>
	<![endif]-->
	<link type="text/css" rel="stylesheet" href="styles/sunlight.default.css">

	
	<link type="text/css" rel="stylesheet" href="styles/site.cosmo.css">
	
</head>

<body>
<div class="container-fluid">
	<div class="navbar navbar-fixed-top ">
		<div class="navbar-inner">
			<a class="brand" href="index.html">WinJS Contrib</a>
			<ul class="nav">
				
				<li class="dropdown">
					<a href="namespaces.list.html" class="dropdown-toggle" data-toggle="dropdown">Namespaces<b
						class="caret"></b></a>

					<ul class="dropdown-menu ">
						
						<li>
							<a href="global.html#WinJSContrib">WinJSContrib</a>
						</li>
						
						<li>
							<a href="WinJSContrib.Alerts.html">Alerts</a>
						</li>
						
						<li>
							<a href="WinJSContrib.Bindings.html">Bindings</a>
						</li>
						
						<li>
							<a href="WinJSContrib.CrossPlatform.html">CrossPlatform</a>
						</li>
						
						<li>
							<a href="WinJSContrib.CrossPlatform.isMobile.html">isMobile</a>
						</li>
						
						<li>
							<a href="WinJSContrib.Logging.html">Logging</a>
						</li>
						
						<li>
							<a href="WinJSContrib.Logging.Appenders.html">Appenders</a>
						</li>
						
						<li>
							<a href="WinJSContrib.Search.html">Search</a>
						</li>
						
						<li>
							<a href="WinJSContrib.Templates.html">Templates</a>
						</li>
						
						<li>
							<a href="WinJSContrib.UI.html">UI</a>
						</li>
						
						<li>
							<a href="WinJSContrib.UI.Animation.html">Animation</a>
						</li>
						
						<li>
							<a href="WinJSContrib.UI.DataForm.Converters.html">Converters</a>
						</li>
						
						<li>
							<a href="WinJSContrib.UI.DataForm.defaultBindingOptions.html">defaultBindingOptions</a>
						</li>
						
						<li>
							<a href="WinJSContrib.UI.DataSources.html">DataSources</a>
						</li>
						
						<li>
							<a href="WinJSContrib.UI.DataSources.Grouping.html">Grouping</a>
						</li>
						
						<li>
							<a href="WinJSContrib.UI.WebComponents.html">WebComponents</a>
						</li>
						
						<li>
							<a href="WinJSContrib.Utils.html">Utils</a>
						</li>
						
						<li>
							<a href="WinJSContrib.Utils.ValueParsers.html">ValueParsers</a>
						</li>
						
						<li>
							<a href="WinJSContrib.WinRT.html">WinRT</a>
						</li>
						

					</ul>
				</li>
				
				<li class="dropdown">
					<a href="classes.list.html" class="dropdown-toggle" data-toggle="dropdown">Classes<b
						class="caret"></b></a>

					<ul class="dropdown-menu ">
						
						<li>
							<a href="WinJSContrib.Logging.Appenders.ConsoleAppender.html">ConsoleAppender</a>
						</li>
						
						<li>
							<a href="WinJSContrib.Logging.LoggerClass.html">LoggerClass</a>
						</li>
						
						<li>
							<a href="WinJSContrib.Messenger.html">Messenger</a>
						</li>
						
						<li>
							<a href="WinJSContrib.Messenger.SmartWorker.html">SmartWorker</a>
						</li>
						
						<li>
							<a href="WinJSContrib.Search.Index.html">Index</a>
						</li>
						
						<li>
							<a href="WinJSContrib.Search.IndexGroup.html">IndexGroup</a>
						</li>
						
						<li>
							<a href="WinJSContrib.Search.Stemming.Pipeline.html">Pipeline</a>
						</li>
						
						<li>
							<a href="WinJSContrib.UI.ChildViewFlyout.html">ChildViewFlyout</a>
						</li>
						
						<li>
							<a href="WinJSContrib.UI.DataForm.html">DataForm</a>
						</li>
						
						<li>
							<a href="WinJSContrib.UI.DataSources.DataSourceManager.html">DataSourceManager</a>
						</li>
						
						<li>
							<a href="WinJSContrib.UI.ElasticInput.html">ElasticInput</a>
						</li>
						
						<li>
							<a href="WinJSContrib.UI.EventTracker.html">EventTracker</a>
						</li>
						
						<li>
							<a href="WinJSContrib.UI.ExtendedSplash.html">ExtendedSplash</a>
						</li>
						
						<li>
							<a href="WinJSContrib.UI.FlipSnap.html">FlipSnap</a>
						</li>
						
						<li>
							<a href="WinJSContrib.UI.FlipViewPager.html">FlipViewPager</a>
						</li>
						
						<li>
							<a href="WinJSContrib.UI.FluentDOM.html">FluentDOM</a>
						</li>
						
						<li>
							<a href="WinJSContrib.UI.FlyoutPage.html">FlyoutPage</a>
						</li>
						
						<li>
							<a href="WinJSContrib.UI.GlobalProgress.html">GlobalProgress</a>
						</li>
						
						<li>
							<a href="WinJSContrib.UI.GridControl.html">GridControl</a>
						</li>
						
						<li>
							<a href="WinJSContrib.UI.HubControl.html">HubControl</a>
						</li>
						
						<li>
							<a href="WinJSContrib.UI.MediaTrigger.html">MediaTrigger</a>
						</li>
						
						<li>
							<a href="WinJSContrib.UI.MultiPassItem.html">MultiPassItem</a>
						</li>
						
						<li>
							<a href="WinJSContrib.UI.MultiPassRenderer.html">MultiPassRenderer</a>
						</li>
						
						<li>
							<a href="WinJSContrib.UI.PageControlNavigator.html">PageControlNavigator</a>
						</li>
						
						<li>
							<a href="WinJSContrib.UI.SemanticListViews.html">SemanticListViews</a>
						</li>
						
						<li>
							<a href="WinJSContrib.UI.SmartListLayout.html">SmartListLayout</a>
						</li>
						
						<li>
							<a href="WinJSContrib.UPnP.UPnPDevice.html">UPnPDevice</a>
						</li>
						

					</ul>
				</li>
				
			</ul>
		</div>
	</div>

	<div class="row-fluid">

		
			<div class="span12">
				
				<div id="main">
					


		<h1 class="page-title">Source: winjscontrib.ui.smartlistlayout.js</h1>
    
    <section>
        <article>
            <pre class="sunlight-highlight-javascript linenums">/* 
 * WinJS Contrib v2.1.0.2
 * licensed under MIT license (see http://opensource.org/licenses/MIT)
 * sources available at https://github.com/gleborgne/winjscontrib
 */

(function () {
    "use strict";

    WinJS.Namespace.define("WinJSContrib.UI", {
        SmartListLayout: WinJS.Class.define(
            /**
             * Control to set ListView layout based on media queries
             * @class WinJSContrib.UI.SmartListLayout
             * @param {HTMLElement} element DOM element containing the control
             * @param {Object} options
             * @example
             *  {@lang xml}
             *  &lt;div id="mylistview" data-win-control="WinJS.UI.ListView" data-win-options="{
             *      itemTemplate: select('#listitemtemplate'),
             *      itemDataSource: DummyDataSource
             *   }">&lt;/div>
             * 
             *  &lt;div id="listlayout" data-win-control="WinJSContrib.UI.SmartListLayout" data-win-options="{
             *          listView: select('#mylistview'),
             *          layouts:{
             *              default : { layout : WinJS.UI.GridLayout, query: '(orientation: landscape)'},
             *              vert : { layout : WinJS.UI.GridLayout, query: '(orientation: portrait) and (min-width: 600px)', options: { orientation : 'vertical'}},
             *              snap : { layout : WinJS.UI.ListLayout, query: '(orientation: portrait) and (max-width: 600px)'},
             *          }
             * }">&lt;/div>
             */
            function ctor(element, options) {
                this._element = element || document.createElement("div");
                this._element.className = this._element.className + ' win-disposable mcn-layout-ctrl';
                this._element.winControl = this;
                this.queries = [];
                this.listView = options ? options.listView : undefined;
                this.layouts = options.layouts;

                if (this.listView &amp;&amp; this.listView.winControl &amp;&amp; options.layouts) {
                    this.initQueries(options.layouts);
                    this.applyPendingLayout();
                }
            },
            /**
             * @lends WinJSContrib.UI.SmartListLayout
             */
            {
                /**
                 * listview target by smart layout
                 * @field
                 * @type WinJS.UI.ListView
                 */
                listView: {
                    get: function () {
                        return this._listview;
                    },
                    set: function (val) {
                        if (val &amp;&amp; val.element &amp;&amp; val.forceLayout)
                            this._listview = val.element;
                        else
                        	this._listview = val;

                        if (val) {
                        	this.initQueries(this.layouts);
                        	this.applyPendingLayout();
                        }
                    }
                },

                initQueries: function (layouts) {
                    var ctrl = this;
                    for (var name in layouts) {
                        if (layouts.hasOwnProperty(name)) {
                            ctrl.add(layouts[name]);
                        }
                    }
                },

                /**
                 * add a layout declaration
                 * @param {Object} layout layout declaration
                 */
                add: function (layout) {
                    var ctrl = this;

                    if (layout &amp;&amp; layout.query &amp;&amp; layout.layout) {
                        var query = {
                            ctrl: ctrl,
                            mediaquery: layout.query,
                            layout: layout.layout,
                            options: layout.options,
                            mq: undefined,
                            bindedCallback: undefined
                        };

                        query.bindedCallback = ctrl.processQuery.bind(query);
                        ctrl.queries.push(query);

                        query.mq = window.matchMedia(layout.query);
                        //query.mq.addListener(function (mq) {
                        //	var t = mq;
                        //});
                        query.mq.addListener(query.bindedCallback);
                        if (query.mq.matches)
                            ctrl.applyQuery(query);
                    }
                },

                processQuery: function (mq) {
                    var query = this;
                    query.ctrl.applyQuery(query);
                },

                applyQuery: function (query) {
                    var ctrl = this;
                    if (query.mq.matches &amp;&amp; ctrl.listView &amp;&amp; ctrl.listView.winControl) {
                        if (!ctrl.pendingLayout) {
                            ctrl.listView.style.opacity = 0;
                            //this makes layout change only once, whatever queries are matching (last matching query will win)
                            setImmediate(function () {
                                ctrl.applyPendingLayout();
                            });
                        }
                        ctrl.pendingLayout = new query.layout(query.options);						
                    }
                },

                applyPendingLayout: function () {
                    var ctrl = this;
                    if (ctrl.pendingLayout) {
                        ctrl.listView.winControl.layout = ctrl.pendingLayout;
                        ctrl.listView.style.opacity = 1;                        
                        ctrl.listView.winControl.forceLayout(); //win 8
                        ctrl.pendingLayout = undefined;
                    }
                },

                updateLayout : function(){
                    var ctrl = this;
                    //if (ctrl.listView) {
                    //    ctrl.listView.winControl.forceLayout();
                    //}
                },

                contentReady: function(){
                    var ctrl = this;
                    //if (ctrl.listView) {
                    //    ctrl.listView.winControl.forceLayout();
                    //}
                },

                dispose: function () {
                    var ctrl = this;
                    //remove listeners for media queries
                    ctrl.queries.forEach(function (query) {
                        query.mq.removeListener(query.bindedCallback);
                    });
                }
            })
    });

    if (WinJSContrib.UI.WebComponents) {
    	WinJSContrib.UI.WebComponents.register('mcn-smartlistlayout', WinJSContrib.UI.SmartListLayout, {
    		properties: ['listView', 'layouts']
    	});
    }
})();</pre>
        </article>
    </section>





				</div>

				<div class="clearfix"></div>
				<footer>
					
					by MCNEXT
					<br />
					
					
		<span class="copyright">
		copyright MCNEXT
		</span>
					<br />
					
		<span class="jsdoc-message">
		Documentation generated by <a href="https://github.com/jsdoc3/jsdoc">JSDoc 3.3.0-alpha5</a>
		on Tue Jul 07 2015 11:05:32 GMT+0200 (Paris, Madrid (heure d’été)) using the <a href="https://github.com/terryweiss/docstrap">DocStrap template</a>.
		</span>
				</footer>
			</div>

			
			<br clear="both">
		</div>

	</div>
	<script src="scripts/sunlight.js"></script>
	<script src="scripts/sunlight.javascript.js"></script>
	<script src="scripts/sunlight-plugin.doclinks.js"></script>
	<script src="scripts/sunlight-plugin.linenumbers.js"></script>
	<script src="scripts/sunlight-plugin.menu.js"></script>
	<script src="scripts/jquery.min.js"></script>
	<script src="scripts/jquery.scrollTo.js"></script>
	<script src="scripts/jquery.localScroll.js"></script>
	<script src="scripts/bootstrap-dropdown.js"></script>
	<script src="scripts/toc.js"></script>


	<script>  Sunlight.highlightAll({lineNumbers:true,  showMenu: true, enableDoclinks :true}); </script>

	<script>
		$( function () {
			$( "#toc" ).toc( {
				selectors   : "h1,h2,h3,h4",
				showAndHide : false,
				scrollTo    : 60
			} );
			$( "#toc>ul" ).addClass( "nav nav-pills nav-stacked" );
			$( "#main span[id^='toc']" ).addClass( "toc-shim" );

		} );
	</script>

	

</body>
</html>
