/* 
 * WinJS Contrib v2.1.0.6
 * licensed under MIT license (see http://opensource.org/licenses/MIT)
 * sources available at https://github.com/gleborgne/winjscontrib
 */

var WinJSContrib;!function(e){var n;!function(n){var t;!function(t){e.Logs.Appenders=e.Logs.Appenders;var r=function(){function t(e){this.config=e||{level:n.Levels.inherit}}return t.prototype.clone=function(){return new e.Logs.Appenders.ConsoleAppender(this.config)},t.prototype.log=function(e,t,r){for(var i=[],o=3;o<arguments.length;o++)i[o-3]=arguments[o];if(this.config.level==n.Levels.inherit||r>=this.config.level){var a=[this.format(e,t,r)];switch(i.length&&i.forEach(function(e){a.push(e)}),r){case n.Levels.verbose:return console.log.apply(console,a);case n.Levels.debug:return console.log.apply(console,a);case n.Levels.info:return console.info.apply(console,a);case n.Levels.warn:return console.warn.apply(console,a);case n.Levels.error:return console.error.apply(console,a)}}},t.prototype.group=function(e){console.group(e)},t.prototype.groupCollapsed=function(e){console.groupCollapsed(e)},t.prototype.groupEnd=function(){console.groupEnd()},t.prototype.format=function(e,t,r){var i="";return e.Config&&e.Config.prefix&&(i+=e.Config.prefix+" # "),this.config.showLoggerNameInMessage&&(i+=e.name+" # "),this.config.showLevelInMessage&&(i+=n.logginLevelToString(r)+" # "),i+=t},t}();t.ConsoleAppender=r;var i=function(){function t(e){this.config=e||{level:n.Levels.inherit},this.buffer=[]}return t.prototype.clone=function(){return new e.Logs.Appenders.BufferAppender(this.config)},t.prototype.log=function(e,t,r){for(var i=[],o=3;o<arguments.length;o++)i[o-3]=arguments[o];if(this.config.level==n.Levels.inherit||r>=this.config.level){var a=[(new Date).getTime()+"",n.Levels[r].toUpperCase(),this.format(e,t,r)];i.length&&i.forEach(function(e){"object"==typeof e&&(e=JSON.stringify(e)),a.push(e)}),this.buffer.push(a.join(" "))}},t.prototype.group=function(e){},t.prototype.groupCollapsed=function(e){},t.prototype.groupEnd=function(){},t.prototype.format=function(e,t,r){var i="";return e.Config&&e.Config.prefix&&(i+=e.Config.prefix+" # "),this.config.showLoggerNameInMessage&&(i+=e.name+" # "),this.config.showLevelInMessage&&(i+=n.logginLevelToString(r)+" # "),i+=t},t}();t.BufferAppender=i}(t=n.Appenders||(n.Appenders={}))}(n=e.Logs||(e.Logs={}))}(WinJSContrib||(WinJSContrib={}));var WinJSContrib;!function(e){var n;!function(n){function t(e,t){var i=s[e];return i||(i=new c(t||n.defaultConfig),i.name=e,s[e]=i),(t||arguments.length>2)&&r.apply(null,arguments),i}function r(e,n){var t=s[e];if(t&&(n&&(t.Config=n),arguments.length>2))for(var r=2;r<arguments.length;r++)t.addAppender(arguments[r])}function i(e){switch(e.toLowerCase()){default:case"log":case"debug":return a.debug;case"info":return a.info;case"warn":return a.warn;case"error":return a.error}}function o(e){switch(e){default:case a.verbose:return"VERBOSE";case a.debug:return"DEBUG";case a.info:return"INFO";case a.warn:return"WARN";case a.error:return"ERROR"}}e.Logs=e.Logs,function(e){e[e.inherit=512]="inherit",e[e.off=256]="off",e[e.error=32]="error",e[e.warn=16]="warn",e[e.info=8]="info",e[e.debug=4]="debug",e[e.verbose=2]="verbose"}(n.Levels||(n.Levels={}));var a=n.Levels;n.defaultConfig={level:a.off,showLevelInMessage:!1,showLoggerNameInMessage:!1,appenders:["DefaultConsole"]};var s={};n.RuntimeAppenders={DefaultConsole:new n.Appenders.ConsoleAppender},n.DefaultAppenders=[],n.getLogger=t,n.configure=r,n.loggingLevelStringToEnum=i,n.logginLevelToString=o;var c=function(){function t(e){this.appenders=[],this.Config=e||n.defaultConfig}return Object.defineProperty(t.prototype,"Config",{get:function(){return this._config},set:function(e){var t=this;this._config=e||{level:n.Levels.off,showLevelInMessage:!1,showLoggerNameInMessage:!1},"number"==typeof e.level&&(this.Level=e.level),"boolean"==typeof e.showLevelInMessage&&(this.Config.showLevelInMessage=e.showLevelInMessage),"boolean"==typeof e.showLoggerNameInMessage&&(this.Config.showLoggerNameInMessage=e.showLoggerNameInMessage),this._config.appenders?this._config.appenders.forEach(function(e){t.addAppender(e)}):this._config.appenders=[],this.checkLevel()},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"Level",{get:function(){return this._level?this._level:this._config.level},set:function(e){this._level=e,this.checkLevel()},enumerable:!0,configurable:!0}),t.prototype.checkLevel=function(){this.verbose=this._level<=n.Levels.verbose?t.verbose:t.noop,this.debug=this._level<=n.Levels.debug?t.debug:t.noop,this.info=this._level<=n.Levels.info?t.info:t.noop,this.warn=this._level<=n.Levels.warn?t.warn:t.noop,this.error=this._level<=n.Levels.error?t.error:t.noop},t.prototype.addAppender=function(n){"string"==typeof n&&(n=e.Logs.RuntimeAppenders[n]);var t=n;if(t){var r=this.appenders.indexOf(t)>=0;r||this.appenders.push(t)}},t.prototype.log=function(t,r){for(var i=[],o=2;o<arguments.length;o++)i[o-2]=arguments[o];if(!(this.Level===e.Logs.Levels.off||r<this.Level)&&this.appenders&&this.appenders.length){var a=[this,t,r];if(i.length)for(var s=0;s<i.length;s++)a.push(i[s]);n.DefaultAppenders.forEach(function(e){e.log.apply(e,a)}),this.appenders.forEach(function(e){e.log.apply(e,a)})}},t.prototype.verbose=function(e){for(var n=[],t=1;t<arguments.length;t++)n[t-1]=arguments[t]},t.prototype.debug=function(e){for(var n=[],t=1;t<arguments.length;t++)n[t-1]=arguments[t]},t.prototype.info=function(e){for(var n=[],t=1;t<arguments.length;t++)n[t-1]=arguments[t]},t.prototype.warn=function(e){for(var n=[],t=1;t<arguments.length;t++)n[t-1]=arguments[t]},t.prototype.error=function(e){for(var n=[],t=1;t<arguments.length;t++)n[t-1]=arguments[t]},t.prototype.group=function(e){this.appenders.forEach(function(n){n.group&&n.group(e)})},t.prototype.groupCollapsed=function(e){this.appenders.forEach(function(n){n.groupCollapsed&&n.groupCollapsed(e)})},t.prototype.groupEnd=function(){this.appenders.forEach(function(e){e.groupEnd&&e.groupEnd()})},t.prototype.getChildLogger=function(n,t){var r=e.Logs.getLogger(this.name+"."+n,JSON.parse(JSON.stringify(this.Config)));return r.Config.appenders=[],this.appenders.forEach(function(e){e.clone&&r.addAppender(e.clone())}),t&&(r.Config.level=t),r},t.noop=function(e){for(var n=[],t=1;t<arguments.length;t++)n[t-1]=arguments[t]},t.getLogFn=function(e){return function(n){var t=null;if(arguments.length>1){t=[];for(var r=1;r<arguments.length;r++)t.push(arguments[r]);this.log(n,e,t)}else this.log(n,e)}},t.verbose=t.getLogFn(n.Levels.verbose),t.debug=t.getLogFn(n.Levels.debug),t.info=t.getLogFn(n.Levels.info),t.warn=t.getLogFn(n.Levels.warn),t.error=t.getLogFn(n.Levels.error),t}();n.Logger=c}(n=e.Logs||(e.Logs={}))}(WinJSContrib||(WinJSContrib={})),function(e){this.setImmediate||(this.setImmediate=function(e){for(var n=[],t=1;t<arguments.length;t++)n[t-1]=arguments[t];return setTimeout(e,0),0}),this.toStaticHTML||(this.toStaticHTML=function(e){return e});var n=e.MSApp;n&&!n.execUnsafeLocalFunction&&(n.execUnsafeLocalFunction=function(e){e()})}(this),Object.map||(Object.map=function(e,n){var t={};return"object"!=typeof e?t:("function"!=typeof n&&(n=function(e,n){return[e,n]}),Object.keys(e).forEach(function(r){var i=n.apply(e,[r,e[r]]);i&&i.length&&(t[i[0]||r]=i[1])}),t)}),String.prototype.format||(String.prototype.format=function(){var e=arguments;return this.replace(/{(\d+)}/g,function(n,t){return"undefined"!=typeof e[t]?e[t]:n})}),String.prototype.padLeft||(String.prototype.padLeft=function(e,n){return void 0===n&&(n="0"),this.length<e?(n+this).padLeft(e,n):this});var WinJSContrib;!function(e){var n;!function(e){function n(e,n){var t=WinJS.Promise.wrap(),r=[];if(!e)return WinJS.Promise.wrap([]);var i=WinJS.Promise.as(e);return i.then(function(e){for(var i=function(e,t){var i,o,a=new WinJS.Promise(function(e,n){i=e,o=n});return e.then(function(e){WinJS.Promise.as(n(t,e)).then(function(e){return r.push(e),e}).then(i,o)}),a},o=0,a=e.length;a>o;o++){var s=e[o];!s&&e.getItem&&(s=e.getItem(o)),t=i(t,s)}return t.then(function(e){return r})})}function t(e,n){if(!e)return WinJS.Promise.wrap([]);var t=WinJS.Promise.as(e);return t.then(function(e){for(var t=[],r=0,i=e.length;i>r;r++){var o=e[r];!o&&e.getItem&&(o=e.getItem(r)),t.push(WinJS.Promise.as(n(o)))}return WinJS.Promise.join(t)})}function r(e,n,t,r){if(!e)return WinJS.Promise.wrap([]);var i=WinJS.Promise.as(e);return i.then(function(e){for(var i=WinJS.Promise.wrap(),o=[],a=[],s=!1,c=function(e,n){var i,o,c=new WinJS.Promise(function(e,n){i=e,o=n});return e.then(function(e){WinJS.Promise.join(n.map(function(e,n){return WinJS.Promise.as(t(e,n))})).then(function(e){return r?r(e):e}).then(function(e){return e=e.concat(e)},function(e){return a=a.concat(e),s=!0,a}).then(i,o)}),c},u=0,l=e.length;l>u;u++){var p=e[u];!p&&e.getItem&&(p=e.getItem(u)),o.push(p),u>0&&u%n===0&&(i=c(i,o),o=[])}return o.length&&(i=c(i,o)),i.then(function(){return s?WinJS.Promise.wrapError(a):a})})}e.waterfall=n,e.parallel=t,e.batch=r}(n=e.Promise||(e.Promise={}))}(WinJSContrib||(WinJSContrib={}));var WinJSContrib;!function(e){var n;!function(n){function t(){for(var e=1;e<arguments.length;e++)for(var n in arguments[e])arguments[e].hasOwnProperty(n)&&(arguments[0][n]=arguments[e][n]);return arguments[0]}function r(e,n){if(!n)return!1;var t=e.match("^"+n)==n;return t}function i(e,n,t){void 0===t&&(t=1);for(var r=0;r<e.length;)setImmediate(function(){for(var i=0;t>i&&r<e.length;i++)r++,n(e[r])})}function o(e,n){return n?e.match(n+"$")==n:!1}function a(n){var t=[];for(var r in n)if(n.hasOwnProperty(r)){var i=encodeURIComponent(r),o=n[r],a=e.Utils.hasValue(o)?encodeURIComponent(o):"";t.push(i+"="+a)}return t.join("&")}function s(e,n,t,r){var i=document.createEvent("Event");i.initEvent(n,t,r),e.dispatchEvent(i)}function c(e,n,t,r,i){var o=document.createEvent("CustomEvent");o.initCustomEvent(n,t,r,i),e.dispatchEvent(o)}function u(e,n){if(e){if("this"===n)return e;var t=e[n];if("undefined"!=typeof t)return t;var r=n.indexOf("[");if(!(0>r)){var i=n.indexOf("]",r);if(!(0>i)){var o=n.substr(r+1,i-r);return o=parseInt(o),e[o]}}}}function l(n,t,r){if(n){if(e.Utils.hasValue(t))return n.setProperty?void n.setProperty(t,r):void(n[t]=r);if("string"==typeof t){var i=t.indexOf("[");if(0>i)return;var o=t.indexOf("]",i);if(0>o)return;var a=t.substr(i+1,o-i),s=parseInt(a);n[s]=r}}}function p(n,t){if(!n)return null;if("string"==typeof t&&n[t])return n[t];if(!t||!t.length)return n;var r=e.Utils.getProperty(n,t);return r?r.propValue:void 0}function f(e,n){"string"==typeof n&&(n=n.split(".")),n&&n.length||(n=["this"]);for(var t=e,r=null,i=0;i<n.length;i++){var o=new q(t,r,n[i]);if(r=o,i==n.length-1)return o;t=u(t,n[i])}}function d(n,t,r){var i=e.Utils.getProperty(n,t);i&&(i.propValue=r)}function g(e,n){return Math.random()*(n-e+1)+e<<0}function v(e,n){return e>n?1:n>e?-1:0}function h(n,t,r){if(null===n||0===n.length)return n;"undefined"==typeof r&&(r=!1);var i,o,a="",s=0,c=[];if(r)for(o=0;o<n.length;o++){if(t){var u=e.Utils.readProperty(n[o],t.split("."));i=u,u||(i=u),u&&u.toLowerCase&&(i=u.toLowerCase())}else i=n[o];a.indexOf("|"+i+"|")<0&&(a+="|"+i+"|",c[s++]=n[o])}else for(o=0;o<n.length;o++)i=t?e.Utils.readProperty(n[o],t.split(".")):n[o],a.indexOf("|"+i+"|")<0&&(a+="|"+i+"|",c[s++]=n[o]);return c}function m(t,r,i){return n.distinctArray(t,r,i).map(function(n){return e.Utils.readProperty(n,r.split("."))})}function y(e){var n=e.toLowerCase();return n=n.replace(new RegExp("[àáâãäå]","g"),"a"),n=n.replace(new RegExp("æ","g"),"ae"),n=n.replace(new RegExp("ç","g"),"c"),n=n.replace(new RegExp("[èéêë]","g"),"e"),n=n.replace(new RegExp("[ìíîï]","g"),"i"),n=n.replace(new RegExp("ñ","g"),"n"),n=n.replace(new RegExp("[òóôõö]","g"),"o"),n=n.replace(new RegExp("œ","g"),"oe"),n=n.replace(new RegExp("[ùúûü]","g"),"u"),n=n.replace(new RegExp("[ýÿ]","g"),"y")}function w(e){var n=[];WinJS.Navigation.history&&WinJS.Navigation.history.backStack&&WinJS.Navigation.history.backStack.length&&WinJS.Navigation.history.backStack.forEach(function(t){t.location!==e&&n.push(t)}),WinJS.Navigation.history.backStack=n}function C(e){return(10>e?"0":"")+e}function S(e,n,t){if(!e)return"";var r=e.length>n,i=r?e.substr(0,n-1):e;return i=t&&r?i.substr(0,i.lastIndexOf(" ")):i,r?i+"...":i}function b(){var e=(new Date).getTime(),n="xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx".replace(/[xy]/g,function(n){var t=(e+16*Math.random())%16|0;return e=Math.floor(e/16),("x"==n?t:7&t|8).toString(16)});return n}function T(e,n){if(e&&e.parentElement)for(var t=e.parentElement;t;){if(t.winControl&&void 0!==t.winControl[n])return t.winControl[n];t=t.parentElement}}function P(e,n){if(e&&n){for(var t=[],r=0;r<e.childNodes.length;r++)t.push(e.childNodes[r]);t.forEach(function(e){n.appendChild(e)})}}function L(e,n){if(n)for(var t=n.parentNode;t;){if(t[e]&&t.winControl)return t.winControl;t=t.parentNode}}function W(e,n){if(n)for(var t=n.parentNode;t;){if(t.classList&&t.classList.contains(e)&&t.winControl)return t.winControl;t=t.parentNode}}function k(n){return e.Utils.getParent("mcnPage",n)}function U(e){for(var n=e.parentNode;n;){if(n.msParentSelectorScope){var t=n.parentNode;if(t){var r=t.winControl;if(r)return r}}n=n.parentNode}}function J(e){if(e){var n=typeof e;if("string"==n)return new WinJS.Binding.Template(null,{href:e});if("function"==n)return{render:function(n,t){var r=e(n,t);return WinJS.Promise.as(r)}};if(e.winControl)return e.winControl;if(e.render)return e}}function E(n,t){var r=e.Utils.resolveValue(n,t);return r&&"function"==typeof r?r:void 0}function I(n,t){var r=e.Utils.resolveValue(n,t);return r?"function"==typeof r?r(n):r:void 0}function A(e,t,r){var i=t.split(":");if(i.length>1){var o=i[0],a=t.substr(o.length+1),s=n.ValueParsers[o];if(s)return s(e,a,r)}return t}function x(n,t,r,i,o){var a=e.Utils.resolveValue(n,t,o);a&&a.then&&a.mcnMustResolve?a.then(function(n){e.Utils.writeProperty(r,i,n)}):e.Utils.writeProperty(r,i,a)}function M(e){return"undefined"!=typeof e&&null!==e}function D(e){return"{0} - {1}: {2}".format(e.status,e.statusText,e.responseText)}function _(e){return function(n){for(var t=null,r=0;r<n.length;r++){var i=n[r];if("undefined"!=typeof i){t=i;break}}return e(t)}}function N(e,n){if(n)for(var t in n)e[t]=n[t]}var O=function(){function e(){}return e.prototype.dispatchEvent=function(e,n){},e.prototype.addEventListener=function(e,n){},e.prototype.removeEventListener=function(e,n){},e}();n.EventDispatcher=O,n.EventDispatcher=WinJS.Class.mix(O,WinJS.Utilities.eventMixin),n.extend=t,n.startsWith=r,String.prototype.startsWith||(String.prototype.startsWith=function(n){return e.Utils.startsWith(this,n)}),n.asyncForEach=i,n.endsWith=o,String.prototype.endsWith||(String.prototype.endsWith=function(n){return e.Utils.endsWith(this,n)}),n.queryStringFrom=a,n.triggerEvent=s,n.triggerCustomEvent=c,n.readProperty=p;var q=function(){function e(e,n,t){this.parent=e,this.parentDescriptor=n,this.keyProp=t}return e.prototype.ensureParent=function(){return parent?parent:void(this.parentDescriptor&&(this.parentDescriptor.ensureParent(),this.parentDescriptor.parent[this.parentDescriptor.keyProp]||(this.parentDescriptor.parent[this.parentDescriptor.keyProp]={},this.parent=this.parentDescriptor.parent[this.parentDescriptor.keyProp])))},Object.defineProperty(e.prototype,"propValue",{get:function(){return u(this.parent,this.keyProp)},set:function(e){this.ensureParent(),l(this.parent,this.keyProp,e)},enumerable:!0,configurable:!0}),e}();n.PropertyDescriptor=q,n.getProperty=f,n.writeProperty=d,n.randomFromInterval=g,n.alphabeticSort=v,n.distinctArray=h,n.getDistinctPropertyValues=m,n.removeAccents=y,n.removePageFromHistory=w,n.pad2=C,n.ellipsisizeString=S,n.guid=b,n.inherit=T,n.moveChilds=P,n.getParent=L,n.getParentControlByClass=W,n.getParentPage=k,n.getScopeControl=U,n.getTemplate=J,n.resolveMethod=E,n.readValue=I,n.ValueParsers={navpage:function(n,t,r){var i=r&&r.data?r.data.navpage:null;if(i||(e.Utils.getParentPage&&(i=e.Utils.getParentPage(n),r&&r.data&&(r.data.navpage=i)),!i&&e.UI.Application.navigator&&(i=e.UI.Application.navigator.pageControl,r&&r.data&&(r.data.navpage=i))),i){r&&(r.parentControl=i);var o=e.Utils.readProperty(i,t);return o&&"function"==typeof o?o.bind(i):o}},page:function(n,t,r){var i=r&&r.data?r.data.page:null;if(i||(i=e.Utils.getParentControlByClass("pagecontrol",n),r&&r.data&&(r.data.page=i)),i){r&&(r.parentControl=i);var o=e.Utils.readProperty(i,t);return o&&"function"==typeof o?o.bind(i):o}},ctrl:function(n,t,r){var i=r&&r.data?r.data.scope:null;if(i||(i=e.Utils.getScopeControl(n),r&&r.data&&(r.data.scope=i)),i){r&&(r.parentControl=i);var o=e.Utils.readProperty(i,t);return o&&"function"==typeof o?o.bind(i):o}},select:function(n,t,r){var i=r&&r.data?r.data.scope:null;i||(i=e.Utils.getScopeControl(n),r&&r.data&&(r.data.scope=i));var n=null,o=t.split("|"),a=o[0];if(i&&(n=i.element.querySelector(a)),n||(n=document.querySelector(a)),1==o.length)return n;if(o.length>1){var s=p(n,t.substr(o[0].length+1));return s}},obj:function(n,t,r){return WinJS.UI.optionsParser(t,window,{select:WinJS.Utilities.markSupportedForProcessing(function(t){var r=e.Utils.getScopeControl(n);return r?r.element.querySelector(t):document.querySelector(t)})})},prom:function(e,n,t){var r=A(e,n,t);return r.then&&(r=r.then(null,null),r.mcnMustResolve=!0),r},list:function(e,n,t){var r=A(e,n,t);if(r){if(r.then){var i=r.then(function(e){return new WinJS.Binding.List(e).dataSource});return i.mcnMustResolve=!0,i}return new WinJS.Binding.List(r).dataSource}},global:function(n,t,r){return e.Utils.readProperty(window,t)},templ:function(n,t,r){return e.Templates.get(t)},element:function(e,n,t){var r=A(e,n,t);return r?r.element:void 0},event:function(e,n,t){var r=A(e,n,t),i=null;r&&t&&t.name&&(t&&(i=t.parentControl),r&&"function"==typeof r&&(i&&i.eventTracker?i.eventTracker.addEvent(t.control,t.name,r):t.control.addEventListener(t.name,r)))}},n.resolveValue=A,n.applyValue=x,n.hasValue=M,n.formatXHRError=D,n.unwrapJoinError=_,n.inject=N}(n=e.Utils||(e.Utils={}))}(WinJSContrib||(WinJSContrib={}));var WinJSContrib;!function(e){var n;!function(n){function t(e){var n=o[e];return o[e]?n:new WinJS.Binding.Template(null,{href:e})}function r(n,t){var r=e.Templates.get(n);if(r)return e.Templates.makeInteractive(r,t);throw{message:"template not found for "+n}}function i(n,t){return function(r){return r.then(function(r){return n.render(r).then(function(n){if(t.tap)for(var i in t.tap){var o=n.querySelector(i);e.UI.tap(o,function(e){t.tap[i](e,r)})}if(t.click)for(var i in t.click){var o=n.querySelector(i);o.onclick=function(e){t.click[i](e,r)}}return n})})}}var o={};n.get=t,n.interactive=r,n.makeInteractive=i}(n=e.Templates||(e.Templates={}))}(WinJSContrib||(WinJSContrib={}));var WinJSContrib;!function(e){var n;!function(n){function t(e,n){for(var t=0,r=0,i=e.clientWidth,o=e.clientHeight;e&&e!=n;)t+=e.offsetLeft-e.scrollLeft+e.clientLeft,r+=e.offsetTop-e.scrollTop+e.clientTop,e=e.offsetParent;return{x:t,y:r,width:i,height:o}}function r(){var e=document.querySelectorAll('div[data-win-control="WinJS.UI.AppBar"],div[data-win-control="WinJS.UI.NavBar"]');if(e&&e.length)for(var n=0;n<e.length;n++){var t=e[n];t.winControl&&t.winControl.show()}}function i(){var e=document.querySelectorAll('div[data-win-control="WinJS.UI.AppBar"],div[data-win-control="WinJS.UI.NavBar"]');if(e&&e.length)for(var n=0;n<e.length;n++){var t=e[n];t.winControl&&t.winControl.hide()}}function o(){var e=document.querySelectorAll('div[data-win-control="WinJS.UI.AppBar"],div[data-win-control="WinJS.UI.NavBar"]');if(e&&e.length)for(var n=0;n<e.length;n++){var t=e[n];t.winControl&&(t.winControl.disabled=!0)}}function a(){var e=document.querySelectorAll('div[data-win-control="WinJS.UI.AppBar"],div[data-win-control="WinJS.UI.NavBar"]');if(e&&e.length)for(var n=0,t=e.length;t>n;n++){var r=e[n];r.winControl&&(r.winControl.disabled=!1)}}function s(e,n){return new WinJS.Promise(function(t,r){function i(n){e.onload=void 0,e.onerror=void 0,e.onreadystatechange=void 0,r("element not loaded")}function o(r){e.onload=void 0,e.onerror=void 0,e.onreadystatechange=void 0,t({element:e,url:n})}e.onerror=i,e.onload=o,e.onreadystatechange=o,e.naturalWidth>0&&o(void 0),e.src=n})}function c(e){return new WinJS.Promise(function(n,t){function r(n){o.onload=void 0,o.onerror=void 0,t({message:"image not loaded : "+e,path:e})}function i(t){o.onload=void 0,o.onerror=void 0,n({element:o,url:e})}var o=new Image;o.onerror=r,o.onload=i,o.naturalWidth>0&&i(void 0),o.src=e})}function u(e){var n=[],t=!1;if(e.parentElement)for(var r=e.parentElement,i=0;i<r.children.length;i++)r.children[i]===e?t=!0:t&&n.push(r.children[i]);return n}function l(n){return new WinJS.Promise(function(t,r){var i=e.UI.listElementsAfterMe(n),o=WinJS.UI.Animation.createDeleteFromListAnimation([n],i);n.style.position="fixed",n.style.opacity="0",o.execute().done(function(){t(n)})})}function p(n,t,r,i){if(n){n.classList.add("page-action");var o=n.dataset.pageAction||n.getAttribute("tap"),a=r[o];a&&"function"==typeof a&&e.UI.tap(n,function(t){var a=WinJS.Promise.wrap(s),s=t.dataset.pageActionArgs||n.getAttribute("tap-args");if(s&&"string"==typeof s){var c=e.Utils.readValue(t,s);a=WinJS.Promise.as(c).then(function(e){if("string"==typeof e)try{e=WinJS.UI.optionsParser(e,window)}catch(n){return}return e}),c&&(s=c)}return a.then(function(e){return r[o].bind(r)({elt:t,args:e,item:i})})})}}function f(e,n,t){var r=e.querySelectorAll("*[data-page-action], *[tap]");if(r&&r.length)for(var i=0,o=r.length;o>i;i++){var a=r[i];p(a,e,n,t)}}function d(n,t,r){if(n){n.classList.add("page-link");var i=n.getAttribute("applink"),o=n.dataset.pageLink||n.getAttribute("linkto");if(o&&o.indexOf("/")<0){var a=e.Utils.readProperty(window,o);a&&(o=a)}if(o){var s=n.dataset.pageActionOptions||n.getAttribute("tap-options");if(s)try{s=WinJS.UI.optionsParser(s,window)}catch(c){return}e.UI.tap(n,function(t){var a=WinJS.Promise.wrap(),s=t.dataset.pageActionArgs||n.getAttribute("linkto-args");if(s&&"string"==typeof s){var c=e.Utils.readValue(t,s);a=WinJS.Promise.as(c).then(function(e){if("string"==typeof e)try{e=WinJS.UI.optionsParser(e,window)}catch(n){}return e})}return!s&&r&&(s={item:r}),a.then(function(n){if(!i&&e.UI.parentNavigator&&e.UI.parentNavigator(t)){var r=e.UI.parentNavigator(t);return r.navigate(o,n)}return WinJS.Navigation.navigate(o,n)})},s)}}}function g(e,n){var t=e.querySelectorAll("*[data-page-link], *[linkto]");if(t&&t.length)for(var r=0,i=t.length;i>r;r++){var o=t[r];d(o,e,n)}}function v(e){for(var n=e.parentNode;n;){if(n.mcnNavigator)return n.winControl;n=n.parentNode}}function h(e,n,t){if(e){e.classList.add("page-member");var r=e.dataset.pageMember||e.getAttribute("member");r||(r=e.id),r&&!t[r]&&(t[r]=e,e.winControl&&(t[r]=e.winControl))}}function m(e,n){var t=e.querySelectorAll("*[data-page-member], *[member]");if(t&&t.length)for(var r=0,i=t.length;i>r;r++){var o=t[r];h(o,e,n)}}function y(n,t,r){e.UI.bindPageActions(n,t,r),e.UI.bindPageLinks(n,r)}function w(n,t){function r(e){var n=new WinJS.Promise(function(e){});e.detail.setPromise(n),n.cancel()}var i={control:n,callback:t};J.push(i);var o=function(e){var n=J.indexOf(i);if(n===J.length-1)for(i.callback.bind(i.control)(e),n--;n>=0&&!e.handled;){var t=J[n];t.callback.bind(t.control)(e),n--}};if(WinJS.Navigation.addEventListener("beforenavigate",r),window.Windows&&window.Windows.Phone)window.Windows.Phone.UI.Input.HardwareButtons.addEventListener("backpressed",o);else{document.addEventListener("backbutton",o);var a=null;e.UI&&e.UI.enableSystemBackButtonVisibility&&window.Windows&&window.Windows.UI&&window.Windows.UI.Core&&window.Windows.UI.Core.SystemNavigationManager&&(a=window.Windows.UI.Core.SystemNavigationManager.getForCurrentView(),a.addEventListener("backrequested",o))}var s=function(e){("Esc"===e.key||"Backspace"===e.key)&&o(e)};return document.body.addEventListener("keypress",s),e.UI.Application&&e.UI.Application.navigator&&e.UI.Application.navigator.addLock(),function(){e.UI.Application&&e.UI.Application.navigator&&e.UI.Application.navigator.removeLock();var n=J.indexOf(i);if(J.splice(n,1),document.body.removeEventListener("keypress",s),WinJS.Navigation.removeEventListener("beforenavigate",r),window.Windows&&window.Windows.Phone)window.Windows.Phone.UI.Input.HardwareButtons.removeEventListener("backpressed",o);else{document.removeEventListener("backbutton",o);var t=null;e.UI&&e.UI.enableSystemBackButtonVisibility&&window.Windows&&window.Windows.UI&&window.Windows.UI.Core&&window.Windows.UI.Core.SystemNavigationManager&&(t=window.Windows.UI.Core.SystemNavigationManager.getForCurrentView(),t.removeEventListener("backrequested",o))}}}function C(e){e&&e.mcnTapTracking&&(e.mcnTapTracking.dispose(),e.mcnTapTracking=null)}function S(e){if(e)for(var n=e.querySelectorAll(".tap"),t=0,r=n.length;r>t;t++)C(n[t])}function b(t,r,i){if(t){var o=function(e){var n=e.currentTarget||e.target,t=n.mcnTapTracking;!n.disabled&&t&&(void 0===e.button||0===e.button||t.allowRickClickTap&&2===e.button)&&(t.lock&&(e.pointerId&&e.currentTarget.setPointerCapture&&e.currentTarget.setPointerCapture(e.pointerId),e.stopPropagation(),e.preventDefault()),WinJS.Utilities.addClass(n,"tapped"),WinJS.Utilities.removeClass(n,"tap-error"),clearTimeout(t.pendingErrorTimeout),t.pointerdown=e.changedTouches?{x:e.changedTouches[0].clientX,y:e.changedTouches[0].clientY}:{x:e.clientX,y:e.clientY},t.animDown(e.currentTarget),t.tapOnDown&&t.invoke(n,e))},a=function(e){var n=e.currentTarget||e.target,t=n.mcnTapTracking;if(t&&t.pointerdown){if(WinJS.Utilities.removeClass(n,"tapped"),e.pointerId&&n.releasePointerCapture)try{n.releasePointerCapture(e.pointerId)}catch(r){console.error(r)}t.disableAnimation||t.animUp(e.currentTarget)}},s=function(e){var n=e.currentTarget||e.target,t=n.mcnTapTracking;if(t&&(void 0===e.button||0===e.button||t.allowRickClickTap&&2===e.button)){if(n.releasePointerCapture)try{n.releasePointerCapture(e.pointerId)}catch(r){console.error(r)}if(t&&!t.tapOnDown){e.stopPropagation();var i=function(){if(t&&t.pointerdown){if(e.changedTouches)var n=Math.abs(t.pointerdown.x-e.changedTouches[0].clientX),r=Math.abs(t.pointerdown.y-e.changedTouches[0].clientY);else var n=Math.abs(t.pointerdown.x-e.clientX),r=Math.abs(t.pointerdown.y-e.clientY);t.callback&&15>n&&15>r&&(e.stopImmediatePropagation(),e.stopPropagation(),e.preventDefault(),t.invoke()),t&&t.pointerdown&&(t.pointerdown=void 0)}};t.awaitAnim?t.animUp(n).done(i):(t.animUp(n),i())}WinJS.Utilities.removeClass(n,"tapped")}};if(!i){var c=t.getAttribute("tap-options");if(c)try{i=WinJS.UI.optionsParser(c,window)}catch(u){return}}var l=i||{};t.mcnTapTracking&&t.mcnTapTracking.dispose(),WinJS.Utilities.addClass(t,"tap"),t.mcnTapTracking=t.mcnTapTracking||{},t.mcnTapTracking.disableAria=l.disableAria||n.defaultTapBehavior.disableAria,t.mcnTapTracking.disableAria||(t.hasAttribute("tabindex")||t.setAttribute("tabindex","0"),t.hasAttribute("role")||t.setAttribute("role","button")),t.mcnTapTracking.eventTracker=new e.UI.EventTracker,t.mcnTapTracking.disableAnimation=l.disableAnimation||n.defaultTapBehavior.disableAnimation,t.mcnTapTracking.disableAnimation?(l.disableAnimation&&WinJS.Utilities.addClass(t,"tap-disableanimation"),t.mcnTapTracking.animDown=function(){return WinJS.Promise.wrap()},t.mcnTapTracking.animUp=function(){return WinJS.Promise.wrap()}):(t.mcnTapTracking.animDown=l.animDown||n.defaultTapBehavior.animDown,t.mcnTapTracking.animUp=l.animUp||n.defaultTapBehavior.animUp),t.mcnTapTracking.element=t,t.mcnTapTracking.callback=r,t.mcnTapTracking.lock=l.lock,t.mcnTapTracking.awaitAnim=l.awaitAnim||n.defaultTapBehavior.awaitAnim,t.mcnTapTracking.errorDelay=l.errorDelay||n.defaultTapBehavior.errorDelay,t.mcnTapTracking.mapClickEvents=l.mapClickEvents||n.defaultTapBehavior.mapClickEvents,t.mcnTapTracking.tapOnDown=l.tapOnDown,t.mcnTapTracking.pointerModel="none",t.mcnTapTracking.invoke=function(e){var n=t;if(n&&n.mcnTapTracking){var r=n.mcnTapTracking;if(r){var i=new Date,o=9e3;if(r.lastinvoke&&(o=i-r.lastinvoke),o<r.mapClickEvents)return void(e&&e.preventDefault&&(e.preventDefault(),e.stopPropagation()));var a=r.callback(n,e);r.lastinvoke=new Date,a&&WinJS.Promise.is(a)&&(n.disabled=!0,WinJS.Utilities.addClass(n,"tap-working"),a.then(function(){n.disabled=!1,WinJS.Utilities.removeClass(n,"tap-working")},function(e){n.disabled=!1,WinJS.Utilities.removeClass(n,"tap-working"),console.error(e),WinJS.Application.queueEvent({type:"mcn-taperror",error:e}),WinJS.Utilities.addClass(n,"tap-error"),r.errorDelay&&(r.pendingErrorTimeout=setTimeout(function(){r.pendingErrorTimeout=null,WinJS.Utilities.removeClass(n,"tap-error")},r.errorDelay))}))}}},t.mcnTapTracking.mapClickEvents>0&&(t.onclick=function(e){t&&e.target==t&&t.mcnTapTracking&&t.mcnTapTracking.invoke(e)}),t.mcnTapTracking.dispose=function(){WinJS.Utilities.removeClass(t,"tap"),this.eventTracker.dispose(),t.mcnTapTracking=null,t=null},void 0!==t.onpointerdown?(t.mcnTapTracking.pointerModel="pointers",t.mcnTapTracking.eventTracker.addEvent(t,"pointerdown",o),t.mcnTapTracking.eventTracker.addEvent(t,"pointerout",a),t.mcnTapTracking.eventTracker.addEvent(t,"pointerup",s)):window.Touch&&!l.noWebkitTouch?(t.mcnTapTracking.pointerModel="touch",t.mcnTapTracking.eventTracker.addEvent(t,"touchstart",function(e){t.mcnTapTracking.cancelMouse=!0,o(e)}),t.mcnTapTracking.eventTracker.addEvent(t,"touchcancel",function(e){setTimeout(function(){t&&t.mcnTapTracking&&(t.mcnTapTracking.cancelMouse=!1)},1e3),a(e)}),t.mcnTapTracking.eventTracker.addEvent(t,"touchend",function(e){setTimeout(function(){t&&t.mcnTapTracking&&(t.mcnTapTracking.cancelMouse=!1)},1e3),s(e)}),t.mcnTapTracking.eventTracker.addEvent(t,"mousedown",function(e){t.mcnTapTracking.cancelMouse||o(e)}),t.mcnTapTracking.eventTracker.addEvent(t,"mouseleave",function(e){a(e)}),t.mcnTapTracking.eventTracker.addEvent(t,"mouseup",function(e){t.mcnTapTracking.cancelMouse?a(e):s(e)})):(t.mcnTapTracking.pointerModel="mouse",t.mcnTapTracking.eventTracker.addEvent(t,"mousedown",o),t.mcnTapTracking.eventTracker.addEvent(t,"mouseleave",a),t.mcnTapTracking.eventTracker.addEvent(t,"mouseup",s))}}function T(e,n){var t=null;return new WinJS.Promise(function(r,i){var o=function(n){n.srcElement===e&&a()},a=function(){clearTimeout(t),e.removeEventListener("transitionend",o,!1),r()};e.addEventListener("transitionend",o,!1),t=setTimeout(a,n||1e3)})}function P(n,t,r){r=r||n,n.classList.add(t+"-enter"),n.getBoundingClientRect(),n.classList.remove(t+"-leave"),n.classList.remove(t+"-leave-active"),e.UI.afterTransition(r).then(function(){}),n.classList.add(t+"-enter-active")}function L(n,t,r){r=r||n,n.classList.add(t+"-leave"),n.classList.remove(t+"-enter"),n.classList.remove(t+"-enter-active"),setImmediate(function(){e.UI.afterTransition(r).then(function(){n.classList.remove(t+"-leave"),n.classList.remove(t+"-leave-active")}),n.classList.add(t+"-leave-active")})}function W(e,n,t){var r=function(n){for(;n.parentElement&&n.parentElement!=e;)n=n.parentElement;return n.parentElement==e?!0:!1},i=function(e){r(e.target)||t&&t.indexOf(e.target)>=0||n.focus()};return document.addEventListener("focus",i,!0),function(){document.removeEventListener("focus",i)}}n.Application={},n.disableAutoResources=!1,n.offsetFrom=t;var k=function(){function e(){this.events=[]}return e.prototype.addEvent=function(e,n,t,r){var i=this;e.addEventListener(n,t,r);var o=function(r){try{if(e.removeEventListener(n,t),!r){var a=i.events.indexOf(o);a>=0&&i.events.splice(a,1)}}catch(s){console.error("unexpected error while releasing callback "+s.message)}};return this.events.push(o),o},e.prototype.addBinding=function(e,n,t){var r=this;e.bind(n,t);var i=function(o){if(e.unbind(n,t),!o){var a=r.events.indexOf(i);a>=0&&r.events.splice(a,1)}};return this.events.push(i),i},e.prototype.dispose=function(){if(this.events&&this.events.length)for(var e=0;e<this.events.length;e++)this.events[e](!0);this.events=[]},e}();n.EventTracker=k,n.appbarsOpen=r,n.appbarsClose=i,n.appbarsDisable=o,n.appbarsEnable=a,n.elementLoaded=s,n.loadImage=c,n.listElementsAfterMe=u,n.removeElementAnimation=l,n.bindPageActions=f,n.bindPageLinks=g,n.parentNavigator=v,n.bindMembers=m,n.bindActions=y;var U=function(){function e(e,n){var t=this;

t.queries=[],t.linkedControl=n;for(var r in e){var i=e[r];i.query&&t.registerMediaEvent(r,i.query,i)}}return e.prototype.dispose=function(){var e=this;e.linkedControl=null,this.queries.forEach(function(e){e.dispose()})},e.prototype.registerMediaEvent=function(e,n,t){var r=this,i=window.matchMedia(n),o={name:e,query:n,data:t,mq:i,dispose:null},a=function(e){e.matches&&r._mediaEvent(e,o)};i.addListener(a),o.dispose=function(){i.removeListener(a)},r.queries.push(o)},e.prototype._mediaEvent=function(e,n){var t=this;t.linkedControl&&WinJS.UI.setOptions(t.linkedControl,n.data),t.dispatchEvent("media",n)},e.prototype.check=function(){var e=this;e.queries.forEach(function(n){var t=window.matchMedia(n.query);t.matches&&e._mediaEvent({matches:!0},n)})},e.prototype.addEventListener=function(e,n,t){},e.prototype.dispatchEvent=function(e,n){return!1},e.prototype.removeEventListener=function(e,n,t){},e}();n.MediaTrigger=U,WinJS.Class.mix(e.UI.MediaTrigger,WinJS.Utilities.eventMixin);var J=[];n.registerNavigationEvents=w,n.untap=C,n.untapAll=S,n.defaultTapBehavior={animDown:null,animUp:null,disableAnimation:!1,disableAria:!1,awaitAnim:!1,errorDelay:3e3,mapClickEvents:0},WinJS&&WinJS.UI&&WinJS.UI.Animation&&(n.defaultTapBehavior.animDown=WinJS.UI.Animation.pointerDown,n.defaultTapBehavior.animUp=WinJS.UI.Animation.pointerUp),n.tap=b,n.afterTransition=T;var E=function(){function n(e,n,t,r){this.element=document.createElement(e),n&&(this.element.className=n),t&&t.appendChild(this.element),this.parent=r,this.childs=[],r&&r.childs.push(this)}return n["for"]=function(e){var t=new n(null);return t.element=e,t},n.fragment=function(){var e=new n(null);return e.element=document.createDocumentFragment(),e},Object.defineProperty(n.prototype,"control",{get:function(){return this.element.winControl},enumerable:!0,configurable:!0}),n.prototype.addClass=function(e){return this.element&&this.element.classList.add(e),this},n.prototype.className=function(e){return this.element&&(this.element.className=e),this},n.prototype.opacity=function(e){return this.element&&(this.element.style.opacity=e),this},n.prototype.display=function(e){return this.element&&(this.element.style.display=e),this},n.prototype.hide=function(){return this.element&&(this.element.style.display="none"),this},n.prototype.visibility=function(e){return this.element&&(this.element.style.visibility=e),this},n.prototype.text=function(e){return this.element&&(this.element.textContent=e),this},n.prototype.html=function(e){return this.element&&(this.element.innerHTML=e),this},n.prototype.attr=function(e,n){return this.element&&this.element.setAttribute(e,n),this},n.prototype.style=function(e,n){return this.element&&(this.element.style[e]=n),this},n.prototype.styles=function(e){var n=this.element.style,t=Object.keys(e);return t.forEach(function(t){n[t]=e[t]}),this},n.prototype.appendTo=function(e){return this.element&&e&&e.appendChild(this.element),this},n.prototype.tap=function(n,t){return this.element&&e.UI.tap(this.element,n,t),this},n.prototype.append=function(e,t,r){var i=new n(e,t,this.element,this);return r&&r(i),this},n.prototype.createChild=function(e,t){var r=new n(e,t,this.element,this);return r},n.prototype.ctrl=function(n,t){var r=n;return"string"==typeof n&&(r=e.Utils.readProperty(window,n)),r&&new r(this.element,t),this},n}();n.FluentDOM=E,n.dismissableShow=P,n.dismissableHide=L,n.forwardFocus=W}(n=e.UI||(e.UI={}))}(WinJSContrib||(WinJSContrib={}));var __global=this,profiler=__global.msWriteProfilerMark||function(){},WinJSContrib;!function(e){var n;!function(n){var t;!function(n){function t(e){var n=window.document.createElement("a");return n.href=e,n.href}function r(){for(var n=[],t=0;t<arguments.length;t++)n[t-0]=arguments[t];return e.Promise.waterfall(n,function(e){return i(e)})}function i(e){var r=t(e);return c[r]?WinJS.Promise.wrap():(s.verbose("preload "+r),c[r]=!0,WinJS.Promise.timeout(n.preloadDelay).then(function(){return WinJS.Utilities.Scheduler.schedule(function(){WinJS.UI.Fragments.cache(r)},WinJS.Utilities.Scheduler.Priority.idle,{},"preload|"+r)}))}function o(e,n,t,r,i,o){var a=[];i&&a.push(WinJS.Promise.as(i.apply(e,r)));var s=n.querySelectorAll(".mcn-layout-ctrl");if(s&&s.length){for(var c=0,u=s.length;u>c;){var l=s[c];if(l){var p=l.winControl[t];p&&a.push(l.winControl.pageLifeCycle?l.winControl.pageLifeCycle.steps.layout.promise:WinJS.Promise.as(p.apply(l.winControl,r)))}l&&l.winControl&&l.winControl.pageLifeCycle?(c+=l.querySelectorAll(".mcn-fragment, .mcn-layout-ctrl").length+1,l.winControl.__checkLayout()):c+=1}return WinJS.Promise.join(a).then(function(){return o?WinJS.Promise.as(o.apply(e,r)):void 0})}return o?WinJS.Promise.as(o.apply(e,r)):WinJS.Promise.wrap()}function a(n,t,r,i){function o(n){i.getFragmentElement&&i.getFragmentElement(n),r&&r.injectToPage&&e.Utils.inject(n,r.injectToPage),n.navigationState={location:t,state:r},i.oncreate&&i.oncreate(n.element,r),i.oninit&&n.pageLifeCycle.steps.init.attach(function(){return i.oninit(n.element,r)}),(n.enterPageAnimation||i.enterPage)&&(n._enterAnimation=n.enterPageAnimation?n.enterPageAnimation:i.enterPage,n.enterPageAnimation=function(){var e=this,n=null;return c.style.opacity="",n=e&&e.getAnimationElements?e.getAnimationElements(!1):e.element,n?e._enterAnimation(n):void 0}),i.onrender&&n.pageLifeCycle.steps.process.attach(function(){i.onrender(n.element,r)}),e.UI.disableAutoResources||n.pageLifeCycle.steps.process.attach(function(){return WinJS.Resources.processAll(c)}),i.closeOldPagePromise&&n.pageLifeCycle.steps.ready.attach(function(){return i.closeOldPagePromise}),i.onready&&n.pageLifeCycle.steps.ready.attach(function(){i.onready&&i.onready(n.element,r)}),n.pageLifeCycle.steps.enter.attach(function(){return n.enterPageAnimation?WinJS.Promise.as(n.enterPageAnimation(c,i)):void(n.element.style.opacity="")}),n.pageLifeCycle.steps.ready.promise.then(a,s)}var a,s;i=i||{};var c=document.createElement("div");c.setAttribute("dir",__global.getComputedStyle(c,null).direction),c.style.opacity="0",n.appendChild(c);{var u=new WinJS.Promise(function(e,n){a=e,s=n}),l=i.parented?WinJS.Promise.as(i.parented):null,p=WinJS.UI.Pages.get(t);new p(c,r,o,l)}return u}var s=e.Logs.getLogger("WinJSContrib.UI.Pages");n.verboseTraces=!1,n.preloadDelay=250;var c={};n.preload=r,n.preloadPath=i,n.defaultFragmentMixins=[{$:function(e){return $(e,this.element||this._element)},q:function(e){return this.element?this.element.querySelector(e):void 0},qAll:function(e){if(this.element){var n=this.element.querySelectorAll(e);return n&&!n.forEach&&(n=[].slice.call(n)),n}}},{initPageMixin:function(){},disposePageMixin:function(){this.promises&&(this.cancelPromises(),this.promises=[])},addPromise:function(e){return this.promises.push(e),e},cancelPromises:function(){var e=this;if(e.promises){for(var n=0;n<e.promises.length;n++)e.promises[n]&&e.promises[n].cancel();e.promises=[]}}},{initPageMixin:function(){this.eventTracker=new e.UI.EventTracker},disposePageMixin:function(){this.eventTracker&&(this.eventTracker.dispose(),this.eventTracker=null)}}],n.renderFragment=a;var u=function(){function n(e){var n=this;this.items=[],this.page=e,this.resolved=!1,e.promises.push(e.pageLifeCycle.steps.ready.promise.then(function(){return n.resolve()}))}return n.prototype.push=function(e){var n=this;this.resolved?setImmediate(function(){n.page.promises.push(WinJS.Promise.as(e()))}):this.items.push(e)},n.prototype.resolve=function(){return this.resolved=!0,this.items.length?(s.verbose("resolve deffered loads"),e.Promise.waterfall(this.items,function(e){return WinJS.Promise.as(e()).then(function(){return WinJS.Promise.timeout()})})):WinJS.Promise.wrap()},n}();n.DefferedLoadings=u;var l=function(){function e(){}return e}();n.PageBase=l;var p=function(){function e(e,t,r){var i=this;this.page=e,this.queue=[],this.isDone=!1,this.stepName=t,n.verboseTraces&&(this.created=new Date),this.promise=new WinJS.Promise(function(e,n){i._resolvePromise=e,i._rejectPromise=n}),e.promises.push(this.promise),r&&r.pageLifeCycle&&r.pageLifeCycle.steps[t].attach(function(){return i.promise})}return e.prototype.attach=function(e){return this.queue&&!this.isDone?(this.queue.push(e),this.promise):WinJS.Promise.as(e())},e.prototype.resolve=function(e){function t(){return r.resolved=new Date,r._resolvePromise(e),n.verboseTraces&&(r.resolved=new Date,s.verbose(r.resolved-r.created+"ms "+r.stepName.toUpperCase()+" "+r.page.pageLifeCycle.profilerMarkIdentifier),profiler("WinJS.UI.Pages:"+r.stepName.toUpperCase()+r.page.pageLifeCycle.profilerMarkIdentifier+",StartTM")),r.promise}var r=this;if(this.isDone=!0,this.queue&&this.queue.length){var i=[];return this.queue.forEach(function(e){i.push(new WinJS.Promise(function(n,t){try{WinJS.Promise.as(e()).then(function(e){n(e)},t)}catch(r){t(r)}}))}),this.queue=null,WinJS.Promise.join(i).then(function(){return t()},this.reject.bind(this))}return this.queue=null,t()},e.prototype.reject=function(e){return this.isDone=!0,this.queue=null,this._rejectPromise(e),WinJS.Promise.wrapError(this.promise)},e}();n.PageLifeCycleStep=p,function(t,r,i,a,l,f,d,g,v,h){"use strict";function m(e){var n=r.document.createElement("a");return n.href=e,n.href}function y(e){return r.document.location.href.toLowerCase()===e.toLowerCase()}function w(e,n){var t=e.prototype.dispose,r=e.prototype.disposePageMixin,o=e.prototype.initPageMixin;return e=i.Class.mix(e,n),t&&n.hasOwnProperty("dispose")&&(e.prototype.dispose=function(){n.dispose.apply(this),t&&t.apply(this)}),t&&n.hasOwnProperty("disposePageMixin")&&(e.prototype.disposePageMixin=function(){n.disposePageMixin.apply(this),r&&r.apply(this)}),t&&n.hasOwnProperty("initPageMixin")&&(e.prototype.initPageMixin=function(){n.initPageMixin.apply(this),o&&o.apply(this)}),e}function C(e,n){var t=Object.keys(e.prototype);return t.forEach(function(t){void 0===n.prototype[t]&&(n.prototype[t]=e.prototype[t])}),e}function S(e,n){return n?"function"==typeof n?(e.prototype._attachedConstructor=n,C(e,n)):"object"==typeof n?w(e,n):e:e}function b(n,t,r,i,a,s){r.style.display&&(n.pageLifeCycle.initialDisplay=r.style.display),r.style.display="none";var c=" uri='"+t+"'"+l._getProfilerMarkIdentifier(n.element);n.pageLifeCycle.profilerMarkIdentifier=c,d("WinJS.UI.Pages:createPage"+c+",StartTM"),e.UI.WebComponents&&(n.pageLifeCycle.observer=e.UI.WebComponents.watch(n.element));var u=g.timeout().then(function(){return n.pageLifeCycle.log(function(){return"URI loading "+n.pageLifeCycle.profilerMarkIdentifier}),n.load(t)}).then(function(e){if(n.pageLifeCycle.log(function(){return"URI loaded "+n.pageLifeCycle.profilerMarkIdentifier}),n._attachedConstructor){var t=new n._attachedConstructor(r,i);r.winControl=t;var o=Object.keys(n);o.forEach(function(e){t[e]=n[e]}),t.pageLifeCycle.page=t,n.pageControl=t,n.dismissed=!0,n=t}return e}),p=u.then(function(e){return g.join({loadResult:e,initResult:n.init(r,i)})}).then(function(e){return n.pageLifeCycle.steps.init.resolve().then(function(){return e})}).then(function(e){return n.render(r,i,e.loadResult)}).then(function(e){return n.rendered(r,i)}).then(function(e){return n.pageLifeCycle.steps.render.resolve()}).then(function(){return e.UI.WebComponents?WinJS.Promise.timeout():void 0});n.elementReady=p.then(function(){return r}),n.renderComplete=p.then(function(){return n.process(r,i)}).then(function(e){return n.pageLifeCycle.steps.process.resolve()}).then(function(){return e.UI.bindMembers(r,n),n.processed(r,i)}).then(function(){return n});var f=function(){a&&a(n),d("WinJS.UI.Pages:createPage"+c+",StopTM")};n.renderComplete.then(f,f),n.layoutComplete=n.renderComplete.then(function(){return s}).then(function(){r.style.display=n.pageLifeCycle.initialDisplay||"";r.getBoundingClientRect();return o(n,r,"pageLayout",[r,i],null,n.pageLayout)}).then(function(){e.UI.bindActions(r,n)}).then(function(e){return n.pageLifeCycle.steps.layout.resolve()}).then(function(){return n}),n.readyComplete=n.layoutComplete.then(function(){n.ready(r,i),n.pageLifeCycle.ended=new Date,n.pageLifeCycle.delta=n.pageLifeCycle.ended-n.pageLifeCycle.created}).then(function(e){return n.pageLifeCycle.steps.ready.resolve()}).then(function(e){return n.pageLifeCycle.steps.enter.resolve()}).then(function(){return n}).then(null,function(e){if(n.error)return n.error(e);if(!e||!e._value||"Canceled"!==e._value.name)return WinJS.Promise.wrapError(e)}),n.__checkLayout=function(){var e=this,n=arguments,t=null;return t=e.updateLayout?WinJS.Promise.as(e.updateLayout.apply(e,n)):WinJS.Promise.wrap(),t.then(function(){return o(e,e.element,"updateLayout",n)})}}function T(t,o){var a=m(t).toLowerCase(),c=U[a];return t=m(t),c||(c=i.Class.define(function(i,o,a,c){var l=this;if(l._attachedConstructor){var d=new this._attachedConstructor(i,o);i.winControl=d;var g=Object.keys(l);g.forEach(function(e){"_attachedConstructor"!==e&&(d[e]=l[e])}),l=d}var v=e.Utils.getScopeControl(i);return f.addClass(i,"win-disposable"),f.addClass(i,"pagecontrol"),f.addClass(i,"mcn-layout-ctrl"),l.promises=[],l.pageLifeCycle={created:new Date,location:t,log:function(e){if(n.verboseTraces){var t=new Date-this.created;s.verbose(t+"ms "+e())}},stop:function(){l.readyComplete.cancel(),l.cancelPromises(),this.observer&&(this.observer.disconnect(),this.observer=null)},steps:{init:new p(l,"init",null),render:new p(l,"render",null),process:new p(l,"process",v),layout:new p(l,"layout",v),ready:new p(l,"ready",v),enter:new p(l,"enter",v)},initialDisplay:null},l.initPageMixin&&l.initPageMixin(),l.defferedLoading=new u(l),l._disposed=!1,l.element=i=i||r.document.createElement("div"),i.msSourceLocation=t,l.uri=t,l.selfhost=y(t),i.winControl=l,l.parentedComplete=c,b(l,t,i,o,a,c),l},J),c=i.Class.mix(c,WinJS.UI.DOMEventMixin),e.UI.Pages.defaultFragmentMixins.forEach(function(e){w(c,e)}),U[a]=c),c=S(c,o),c.selfhost=y(t),c}function P(e,n){var i=U[e];return i||(i=T(e)),n&&(i=S(i,n)),i.selfhost&&WinJS.Utilities.ready(function(){L(m(e),r.document.body)},!0),a.viewMap||a._viewMap||"function"==typeof n||t._corePages.define(e,n),i}function L(e,n,t,r){var i=a.get(e);c[m(e)]=!0;var o=new i(n,t,null,r);return o.renderComplete.then(null,function(e){return g.wrapError({error:e,page:o})})}function W(e){var n=U[e];return n||(n=P(e)),n}function k(e){v.clearCache(m(e)),delete U[e.toLowerCase()]}if(r.document&&a){var U=a._viewMap||a.viewMap||{},J={dispose:function(){this._disposed||(this.disposePageMixin&&this.disposePageMixin(),this.pageLifeCycle.stop(),this.pageLifeCycle=null,this._disposed=!0,this.readyComplete.cancel(),f.disposeSubTree(this.element),this.element=null)},init:function(){},load:function(e){return this.selfhost?void 0:v.renderCopy(m(e))},process:function(e,n){return h.processAll(e)},processed:function(e,n){},render:function(e,n,t){return this.selfhost||e.appendChild(t),e},rendered:function(e,n){},ready:function(){}};t._corePages={get:a.get,render:a.render,define:a.define,_remove:a._remove,_viewMap:U};var E={define:P,get:W,render:L,_remove:k,_viewMap:U},I=WinJS.UI.Pages;WinJS.Namespace._moduleDefine(t,null,E),I.get=E.get,I.define=E.define,I.render=E.render,I._remove=E._remove,WinJS.UI.HtmlControl=WinJS.Class.define(function(e,n,t){WinJS.UI.Pages.render(n.uri,e,n).then(t,function(){t()})})}}(e.UI.Pages,__global,WinJS,WinJS.UI.Pages,WinJS.Utilities,WinJS.Utilities,profiler,WinJS.Promise,WinJS.UI.Fragments,WinJS.UI)}(t=n.Pages||(n.Pages={}))}(n=e.UI||(e.UI={}))}(WinJSContrib||(WinJSContrib={}));