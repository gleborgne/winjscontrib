/* 
 * WinJS Contrib v2.1.0.6
 * licensed under MIT license (see http://opensource.org/licenses/MIT)
 * sources available at https://github.com/gleborgne/winjscontrib
 */

var WinJSContrib=WinJSContrib||{};WinJSContrib.UI=WinJSContrib.UI||{},WinJSContrib.UI.DataSources=WinJSContrib.UI.DataSources||{},function(t,i){"use strict";t.DataSourceManager=WinJS.Class.mix(WinJS.Class.define(function(t){this.groupedList=null,this.list=null,this.defaultGroupLimit=0,this.filters=new WinJS.Binding.List,this.filters.onitemchanged=this.init.bind(this),this.filters.oniteminserted=this.init.bind(this),this.filters.onitemremoved=this.init.bind(this),this.apply(t)},{apply:function(t){t=t||{},t.field&&(this.field=t.field),t.defaultGroupLimit&&(this.defaultGroupLimit=t.defaultGroupLimit),t.filter&&(this.filter=t.filter),t.groupKind&&(t.groupKind!=this.groupKind&&(this.groupKind=t.groupKind),t=t.groupKind(t)),t.defaultGroupName&&(this.defaultGroupName=t.defaultGroupName),t.compareGroups&&(this.compareGroups=t.compareGroups),t.getGroupKey&&(this.getGroupKey=t.getGroupKey),t.getGroupData&&(this.getGroupData=t.getGroupData),t.listview&&(this.listview=t.listview),t.zoomedOutListView&&(this.zoomedOutListView=t.zoomedOutListView),t.items&&(this.items=t.items)},field:{get:function(){return this._field},set:function(t){this._field=t}},defaultGroupLimit:{get:function(){return this._defaultGroupLimit},set:function(t){this._defaultGroupLimit=t}},groupKind:{get:function(){return this._groupKind},set:function(t){t!=this._groupKind&&(this._groupKind=t,this.apply({groupKind:t}),this.init()),t||(this.compareGroups=null,this.getGroupData=null,this.getGroupKey=null)}},listview:{get:function(){return this._listview},set:function(t){this._listview&&this.detach(),this._listview=t}},groupedList:{get:function(){return this._groupedList},set:function(t){this._groupedList=t}},filter:{get:function(){return this._filter},set:function(t){this._filter&&this.detach(),this._filter=t,t&&this.init()}},items:{get:function(){return this._items},set:function(t){this._items&&this.detach(),this._items=t,t?this.init():(this.list=null,this.groupedList=null,this.filteredlist=null,this.detach())}},_filterItems:function(t){var i=this,e=function(t){return!0};if(this.filter&&(e=function(t){return i.filter(t)}),this.filters.length)for(var r=function(t,i){return function(e){var r=t(e);return r?i(e):!1}},o=0;o<this.filters.length;o++){var n=this.filters.getAt(o);e=r(e,n)}return e},refresh:function(){this.init()},init:function(t){var i=this;if(this.detach(),this.items){if(this.list=new WinJS.Binding.List(this.items),this.filter||this.filters.length){var e=this._filterItems();this.filteredlist=this.list.createFiltered(e)}else this.filteredlist=this.list;if(this.getGroupKey&&this.getGroupData&&this.compareGroups){this.groupedList=this.filteredlist.createGrouped(this.getGroupKey.bind(this),this.getGroupData.bind(this),this.compareGroups.bind(this));var r=i.groupedList.groups;for(var o in r._groupItems){console.log(o);var n=i.groupedList._groupsProjection._groupItems[o];n&&void 0!==n.groupSize&&(n.data.groupCount=n.groupSize)}}else this.groupedList=null;t||this.attach()}},prepareItems:function(t){this.detach(),this._items=t,this.init(!0)},attach:function(){if((this.groupedList||this.filteredlist)&&this.listview)if(this.groupedList&&this.groupedList.length>=this.defaultGroupLimit){this.listview.itemDataSource=this.groupedList.dataSource,this.listview.groupDataSource=this.groupedList.groups.dataSource,this.zoomedOutListView&&(this.zoomedOutListView.itemDataSource=this.groupedList.groups.dataSource);var t=this.parentSemanticZoom();t&&(t.locked=!1)}else if(this.filteredlist&&(this.filteredlist.length>=this.defaultGroupLimit||!this.groupedList)){this.listview.itemDataSource=this.filteredlist.dataSource,this.listview.groupDataSource=null;var t=this.parentSemanticZoom();t&&(t.locked=!0)}else{this.groupedList&&(this.listview.itemDataSource=this.groupedList.dataSource),this.listview.groupDataSource=null,this.zoomedOutListView&&(this.zoomedOutListView.itemDataSource=null);var t=this.parentSemanticZoom();t&&(t.locked=!0)}},parentSemanticZoom:function(){for(var t=this.listview.element.parentElement;t;){if(t.classList.contains("win-semanticzoom"))return t.winControl;t=t.parentElement}},detach:function(){this.listview&&(this.listview.itemDataSource=null,this.listview.groupDataSource=null,this.zoomedOutListView&&(this.zoomedOutListView.itemDataSource=null))}}),WinJS.UI.DOMEventMixin),WinJSContrib.UI.SemanticListViews=WinJS.Class.mix(WinJS.Class.define(function(t,i){this.element=t||document.createElement("DIV"),i=i||{},this.element.winControl=this,this.element.classList.add("win-disposable"),WinJS.UI.setOptions(this,i),this._initControl(i)},{semanticZoom:{get:function(){return this._semanticZoom},set:function(t){this._semanticZoom=t}},listview:{get:function(){return this._listview},set:function(t){this._listview=t}},zoomedOutListview:{get:function(){return this._zoomedOutListview},set:function(t){this._zoomedOutListview=t}},dataManager:{get:function(){return this._dataManager}},_initControl:function(i){var e=document.createElement("DIV");e.style.width="100%",e.style.height="100%";var r=document.createElement("DIV");r.style.width="100%",r.style.height="100%",r.className="zoomedinlist";var o=document.createElement("DIV");o.style.width="100%",o.style.height="100%",o.className="zoomedoutlist",e.appendChild(r),e.appendChild(o),this.element.appendChild(e),this._listview=new WinJS.UI.ListView(r,i.listview),this._zoomedOutListview=new WinJS.UI.ListView(o,i.zoomedOutListview),this._semanticZoom=new WinJS.UI.SemanticZoom(e,i.semanticzoom);var n=i.data||{};n.listview=this._listview,n.zoomedOutListView=this._zoomedOutListview,this._dataManager=new t.DataSourceManager(n)},dispose:function(){WinJS.Utilities.disposeSubTree(this.element)}}),WinJS.UI.DOMEventMixin,WinJS.Utilities.createEventProperties("myevent"))}(WinJSContrib.UI.DataSources,WinJSContrib.UI.DataSources.Grouping),WinJSContrib.UI.WebComponents&&WinJSContrib.UI.WebComponents.register("mcn-semanticlistviews",WinJSContrib.UI.SemanticListViews,{properties:[],controls:{listview:WinJS.UI.ListView,zoomedOutListview:WinJS.UI.ListView,semanticZoom:WinJS.UI.SemanticZoom},map:{DEFAULTGROUPLIMIT:{attribute:"defaultGroupLimit",property:"_dataManager.defaultGroupLimit",resolve:!0},GROUPKIND:{attribute:"groupKind",property:"_dataManager.groupKind",resolve:!0},FIELD:{attribute:"field",property:"_dataManager.field",resolve:!0},ITEMS:{attribute:"items",property:"_dataManager.items",resolve:!0}}}),WinJSContrib.UI.DataSources.Grouping=WinJSContrib.UI.DataSources.Grouping||{},function(t,i){"use strict";WinJSContrib.UI.DataSources.Grouping.alphabetic=WinJS.Utilities.markSupportedForProcessing(function(t){return t=t||{},t.defaultGroupName=t.defaultGroupName||"#",t.compareGroups=t.compareGroups||function(t,i){return t.toUpperCase().charCodeAt(0)-i.toUpperCase().charCodeAt(0)},t.getGroupKey=t.getGroupKey||function(t){if(!t)return this.defaultGroupName;var i=WinJSContrib.Utils.readProperty(t,this.field);if(!i||!i[0])return this.defaultGroupName;var e=i[0].toUpperCase();return e},t.getGroupData=t.getGroupData||function(t){var i="#";t&&(i=WinJSContrib.Utils.readProperty(t,this.field)),i&&i[0]||(i=this.defaultGroupName);var e=i[0].toUpperCase();return{title:e}},t}),WinJSContrib.UI.DataSources.Grouping.byField=WinJS.Utilities.markSupportedForProcessing(function(t){return t.defaultGroupName=t.defaultGroupName||"#",t.compareGroups=t.compareGroups||function(t,i){return t>i?1:i>t?-1:0},t.getGroupKey=t.getGroupKey||function(i){if(!i)return t.defaultGroupNam;var e=WinJSContrib.Utils.readProperty(i,this.field);if(!e)return this.defaultGroupName;var r=e.toString();return"string"!=typeof e&&null!=e.length&&void 0!=e.length&&(r=e.join(", ")),0==r.trim().length&&(r=t.defaultGroupName),r=r.toUpperCase(),r||t.defaultGroupName},t.getGroupData=t.getGroupData||function(i){var e="#";i&&(e=WinJSContrib.Utils.readProperty(i,this.field)),e||(e=this.defaultGroupName);var r=e.toString();return"string"!=typeof e&&null!=e.length&&void 0!=e.length&&(r=e.join(", ")),0==r.trim().length&&(r=t.defaultGroupName),{title:r||t.defaultGroupName}},t}),WinJSContrib.UI.DataSources.Grouping.byYear=WinJS.Utilities.markSupportedForProcessing(function(t){return t.defaultGroupName=t.defaultGroupName||"#",t.compareGroups=t.compareGroups||function(t,i){return t>i?1:i>t?-1:0},t.getGroupKey=t.getGroupKey||function(t){if(!t)return this.defaultGroupName;var i=WinJSContrib.Utils.readProperty(t,this.field);if(!i)return this.defaultGroupName;var e=new Date(new Date(new Date(i).setMonth(0,1)).setHours(0,0,0,0));return e.toISOString()},t.getGroupData=t.getGroupData||function(t){var i="#";t&&(i=WinJSContrib.Utils.readProperty(t,this.field)),i||(i=this.defaultGroupName);var e=new Date(new Date(new Date(i).setMonth(0,1)).setHours(0,0,0,0));return{title:e.getFullYear().toString(),date:e}},t}),WinJSContrib.UI.DataSources.Grouping.byMonth=WinJS.Utilities.markSupportedForProcessing(function(t){return t.defaultGroupName=t.defaultGroupName||"#",t.compareGroups=t.compareGroups||function(t,i){return t>i?1:i>t?-1:0},t.getGroupKey=t.getGroupKey||function(t){if(!t)return this.defaultGroupName;var i=WinJSContrib.Utils.readProperty(t,this.field);if(!i)return this.defaultGroupName;var e=new Date(new Date(new Date(i).setDate(1)).setHours(0,0,0,0));return e.toISOString()},t.getGroupData=t.getGroupData||function(t){var i="#";t&&(i=WinJSContrib.Utils.readProperty(t,this.field)),i||(i=this.defaultGroupName);var e=new Date(new Date(new Date(i).setDate(1)).setHours(0,0,0,0));return{title:WinJSContrib.Utils.pad2(e.getMonth()+1)+"-"+e.getFullYear().toString(),date:e}},t}),WinJSContrib.UI.DataSources.Grouping.byDay=WinJS.Utilities.markSupportedForProcessing(function(t){return t.defaultGroupName=t.defaultGroupName||"#",t.compareGroups=t.compareGroups||function(t,i){return t>i?1:i>t?-1:0},t.getGroupKey=t.getGroupKey||function(t){if(!t)return this.defaultGroupName;var i=WinJSContrib.Utils.readProperty(t,this.field);if(!i)return this.defaultGroupName;var e=new Date(new Date(i).setHours(0,0,0,0));return e.toISOString()},t.getGroupData=t.getGroupData||function(t){var i="#";t&&(i=WinJSContrib.Utils.readProperty(t,this.field)),i||(i=this.defaultGroupName);var e=new Date(new Date(i).setHours(0,0,0,0));return{title:WinJSContrib.Utils.pad2(e.getMonth()+1)+"-"+WinJSContrib.Utils.pad2(e.getDate())+"-"+e.getFullYear().toString(),date:e}},t})}(WinJSContrib.UI.DataSources,WinJSContrib.UI.DataSources.Grouping);