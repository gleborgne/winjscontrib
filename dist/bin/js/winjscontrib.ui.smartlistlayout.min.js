/* 
 * WinJS Contrib v2.1.0.4
 * licensed under MIT license (see http://opensource.org/licenses/MIT)
 * sources available at https://github.com/gleborgne/winjscontrib
 */

!function(){"use strict";WinJS.Namespace.define("WinJSContrib.UI",{SmartListLayout:WinJS.Class.define(function(i,t){this._element=i||document.createElement("div"),this._element.className=this._element.className+" win-disposable mcn-layout-ctrl",this._element.winControl=this,this.queries=[],this.listView=t?t.listView:void 0,this.layouts=t.layouts,this.listView&&this.listView.winControl&&t.layouts&&(this.initQueries(t.layouts),this.applyPendingLayout())},{listView:{get:function(){return this._listview},set:function(i){this._listview=i&&i.element&&i.forceLayout?i.element:i,i&&(this.initQueries(this.layouts),this.applyPendingLayout())}},initQueries:function(i){var t=this;for(var e in i)i.hasOwnProperty(e)&&t.add(i[e])},add:function(i){var t=this;if(i&&i.query&&i.layout){var e={ctrl:t,mediaquery:i.query,layout:i.layout,options:i.options,mq:void 0,bindedCallback:void 0};e.bindedCallback=t.processQuery.bind(e),t.queries.push(e),e.mq=window.matchMedia(i.query),e.mq.addListener(e.bindedCallback),e.mq.matches&&t.applyQuery(e)}},processQuery:function(i){var t=this;t.ctrl.applyQuery(t)},applyQuery:function(i){var t=this;i.mq.matches&&t.listView&&t.listView.winControl&&(t.pendingLayout||(t.listView.style.opacity=0,setImmediate(function(){t.applyPendingLayout()})),t.pendingLayout=new i.layout(i.options))},applyPendingLayout:function(){var i=this;i.pendingLayout&&(i.listView.winControl.layout=i.pendingLayout,i.listView.style.opacity=1,i.listView.winControl.forceLayout(),i.pendingLayout=void 0)},updateLayout:function(){},contentReady:function(){},dispose:function(){var i=this;i.queries.forEach(function(i){i.mq.removeListener(i.bindedCallback)})}})}),WinJSContrib.UI.WebComponents&&WinJSContrib.UI.WebComponents.register("mcn-smartlistlayout",WinJSContrib.UI.SmartListLayout,{properties:["listView","layouts"]})}();